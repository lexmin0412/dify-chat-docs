"use strict";(self.webpackChunkdify_chat_docs=self.webpackChunkdify_chat_docs||[]).push([["2047"],{5502:function(e,a,n){n.r(a),n.d(a,{default:()=>d});var r=n(1549),s=n(6603);function i(e){let a=Object.assign({h1:"h1",a:"a",p:"p",h3:"h3",pre:"pre",code:"code"},(0,s.ah)(),e.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(a.h1,{id:"自定义数据库类型",children:["自定义数据库类型",(0,r.jsx)(a.a,{className:"header-anchor","aria-hidden":"true",href:"#自定义数据库类型",children:"#"})]}),"\n",(0,r.jsx)(a.p,{children:"默认情况下，Dify Chat 使用 MySQL 进行应用配置的持久化存储。"}),"\n",(0,r.jsxs)(a.h3,{id:"1-使用-mysql",children:["1. 使用 MySQL",(0,r.jsx)(a.a,{className:"header-anchor","aria-hidden":"true",href:"#1-使用-mysql",children:"#"})]}),"\n",(0,r.jsx)(a.p,{children:"如果你有 MySQL 数据库，那么非常简单，只需要构建一个用于存放 Dify Chat 数据的数据库连接并配置在环境变量："}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-shell",children:"mysql://username:password@host:port/database_name\n"})}),"\n",(0,r.jsxs)(a.h3,{id:"2-使用其他数据库",children:["2. 使用其他数据库",(0,r.jsx)(a.a,{className:"header-anchor","aria-hidden":"true",href:"#2-使用其他数据库",children:"#"})]}),"\n",(0,r.jsx)(a.p,{children:"如果你的数据库是其他类型，则需要修改代码。下面以 PostgreSQL 为例说明如何配置。"}),"\n",(0,r.jsx)(a.p,{children:"首先，修改 Prisma 配置文件中的数据库类型："}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-shell",meta:'title="packages/platform/prisma/schema.prisma"',children:'datasource db {\n  provider = "postgresql"\n}\n'})}),"\n",(0,r.jsx)(a.p,{children:"然后在 .env 中配置你的数据库连接地址："}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-shell",meta:'title="packages/platform/.env"',children:"DATABASE_URL=postgres://username:password@ip:port/dify-chat\n"})}),"\n",(0,r.jsx)(a.p,{children:"重新生成 Prisma 客户端文件并同步表结构："}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-shell",children:"# 重新生成客户端文件\npnpm --filter dify-chat-platform db:generate\n\n# 删除 migrations 目录\nrm -rf packages/platform/prisma/migrations\n\n# 重置迁移历史\npnpm --filter dify-chat-platform exec prisma migrate reset\n\n# 重新生成迁移文件\npnpm --filter dify-chat-platform exec prisma migrate dev\n"})}),"\n",(0,r.jsx)(a.p,{children:"最后，按照你喜欢的方式（Docker 或者脚本）启动即可。"})]})}function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:a}=Object.assign({},(0,s.ah)(),e.components);return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(i,{...e})}):i(e)}let d=t;t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["Latest%2Fguide%2Fdeploy%2Fdb-config.md"]={toc:[{text:"1. 使用 MySQL",id:"1-使用-mysql",depth:3},{text:"2. 使用其他数据库",id:"2-使用其他数据库",depth:3}],title:"自定义数据库类型",headingTitle:"自定义数据库类型",frontmatter:{}}}}]);