"use strict";(self.webpackChunkdify_chat_docs=self.webpackChunkdify_chat_docs||[]).push([["6231"],{4446:function(e,n,s){s.r(n),s.d(n,{default:()=>c});var d=s(1549),r=s(6603);function i(e){let n=Object.assign({h1:"h1",a:"a",p:"p",img:"img",h2:"h2",h3:"h3",pre:"pre",code:"code",h4:"h4",ul:"ul",li:"li"},(0,r.ah)(),e.components);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(n.h1,{id:"对话输入参数",children:["对话输入参数",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#对话输入参数",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"Dify 应用支持配置初始参数，在对话开启时，展示在界面上供用户输入。"}),"\n",(0,d.jsx)(n.p,{children:"默认情况下，同一个对话只允许输入一次参数值，在后续对话时，将会禁用输入控件。"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{src:"/sample_app_input_disabled.png",alt:"应用输入参数-默认"})}),"\n",(0,d.jsxs)(n.h2,{id:"1-支持在对话开始后更新参数",children:["1. 支持在对话开始后更新参数",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#1-支持在对话开始后更新参数",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"在应用配置中，你可以选择是否允许用户在对话开始后更新参数值。"}),"\n",(0,d.jsx)(n.p,{children:'在界面上编辑应用配置，将 "对话参数配置" 中的 "更新历史参数" 设为 "启用" 即可。'}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{src:"/sample_app_input_setting.png",alt:"应用输入参数-配置"})}),"\n",(0,d.jsxs)(n.h3,{id:"读取-url-作为应用参数",children:["读取 URL 作为应用参数",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#读取-url-作为应用参数",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"在实际应用场景下，我们可能有需要在 URL 中动态传入参数值，填入表单。"}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{src:"/sample_app_input_intro.png",alt:"读取 URL 作为应用参数-说明"})}),"\n",(0,d.jsx)(n.p,{children:"为了支持此功能，你的 URL 需要定义成如下形式："}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:"<dify-chat-address>/dify-chat/app/<appId>?<paramName>=<encodedParamValue>&isNewCvst=1\n"})}),"\n",(0,d.jsxs)(n.h4,{id:"应用示例---订单号填入",children:["应用示例 - 订单号填入",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#应用示例---订单号填入",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"默认情况下，对话参数的值为空："}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{src:"/sample_app_input_default.jpg",alt:"读取 URL 作为应用参数-默认"})}),"\n",(0,d.jsx)(n.p,{children:"我们可以在 URL 中拼接参数："}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-shell",children:"http://localhost:5200/dify-chat/app/${appId}?orderNo=${encodedValue}&isNewCvst=1\n"})}),"\n",(0,d.jsx)(n.p,{children:"说明："}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"appId"}),", 应用 ID"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"encodedValue"}),", 经过 ",(0,d.jsx)(n.code,{children:"Gzip"})," 和 ",(0,d.jsx)(n.code,{children:"encodeUriComponent"})," 处理后的参数值"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"isNewCvst"}),", 指定需要开启新对话（如果不指定且存在历史对话时，默认将会选中最近一个对话）"]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"encodedValue"})," 生成方式（NodeJS）："]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-javascript",children:'import zlib from \'zlib\'\n\nconst originalOrderNo = "123456";\nconst buffer = Buffer.from(originalOrderNo, "utf8");\nlet encodedValue = "";\n\nzlib.gzip(buffer, (err, compressedBuffer) => {\n  if (err) {\n    console.error("压缩时出错:", err);\n    return;\n  }\n  const encodedString = compressedBuffer.toString("base64");\n  encodedValue = encodeURIComponent(encodedString);\n  console.log("压缩后的 Base64:", encodedValue);\n});\n'})}),"\n",(0,d.jsxs)(n.p,{children:["将 ",(0,d.jsx)(n.code,{children:"encodedValue"})," 填入链接后访问，可以看到我们定义的 ",(0,d.jsx)(n.code,{children:"orderNo: 123456"})," 已经被填入表单："]}),"\n",(0,d.jsx)(n.p,{children:(0,d.jsx)(n.img,{src:"/sample_app_input_filled.jpg",alt:"读取 URL 作为应用参数-结果"})}),"\n",(0,d.jsxs)(n.h2,{id:"2-全局参数缓存",children:["2. 全局参数缓存",(0,d.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#2-全局参数缓存",children:"#"})]}),"\n",(0,d.jsx)(n.p,{children:"有时候，对于一些固定的业务参数，我们可能需要在多个应用/对话中共享输出参数值，不需要用户重复输入，这时候可以使用全局参数缓存功能。"}),"\n",(0,d.jsxs)(n.p,{children:["要使用全局参数缓存非常简单，只需要在正常传递参数的同时，加上一个 ",(0,d.jsx)(n.code,{children:"&isKeepAll=true"})," 即可。"]}),"\n",(0,d.jsx)(n.p,{children:"例如："}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"http://localhost:5200/dify-chat/app/cmdx5fmtb0000364zs23s6nez?orderNo=H4sIAAAAAAAAEzM0MjYxNQMAYdNyCQYAAAA%3D&isNewCvst=1&isKeepAll=true\n"})}),"\n",(0,d.jsx)(n.p,{children:"参数说明："}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"isKeepAll"}),", 指定是否需要缓存参数值, 在进入其他对话时复用","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"true"}),", 缓存参数值"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(n.p,{children:"整个链接将会有如下效果："}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["开启新对话（",(0,d.jsx)(n.code,{children:"isNewCvst=1"}),"）"]}),"\n",(0,d.jsxs)(n.li,{children:["缓存参数值（",(0,d.jsx)(n.code,{children:"isKeepAll=true"}),"）","\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["进入其他对话后，会自动将 ",(0,d.jsx)(n.code,{children:"orderNo"})," 参数值填入表单"]}),"\n"]}),"\n"]}),"\n"]})]})}function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,r.ah)(),e.components);return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(i,{...e})}):i(e)}let c=l;l.__RSPRESS_PAGE_META={},l.__RSPRESS_PAGE_META["v0.5.x%2Fguide%2Ffeatures%2Fconversation-input-params.mdx"]={toc:[{text:"1. 支持在对话开始后更新参数",id:"1-支持在对话开始后更新参数",depth:2},{text:"读取 URL 作为应用参数",id:"读取-url-作为应用参数",depth:3},{text:"应用示例 - 订单号填入",id:"应用示例---订单号填入",depth:4},{text:"2. 全局参数缓存",id:"2-全局参数缓存",depth:2}],title:"对话输入参数",headingTitle:"对话输入参数",frontmatter:{}}}}]);