"use strict";(self.webpackChunkdify_chat_docs=self.webpackChunkdify_chat_docs||[]).push([["7940"],{5968:function(e,n,s){s.r(n),s.d(n,{default:()=>d});var a=s(1549),i=s(6603);function r(e){let n=Object.assign({h1:"h1",code:"code",a:"a",p:"p",img:"img",h2:"h2",pre:"pre",blockquote:"blockquote",h3:"h3",strong:"strong",h4:"h4",ul:"ul",li:"li",ol:"ol"},(0,i.ah)(),e.components);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.h1,{id:"dify-chatapi",children:[(0,a.jsx)(n.code,{children:"@dify-chat/api"}),(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#dify-chatapi",children:"#"})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.img,{src:"https://img.shields.io/npm/v/@dify-chat/api",alt:"version"})," ",(0,a.jsx)(n.img,{src:"https://img.shields.io/npm/last-update/@dify-chat/api",alt:"NPM Last Update"})," ",(0,a.jsx)(n.img,{src:"https://img.shields.io/npm/dm/@dify-chat/api",alt:"NPM Downloads"})]}),"\n",(0,a.jsxs)(n.p,{children:[(0,a.jsx)(n.code,{children:"@dify-chat/api"})," 是 ",(0,a.jsx)(n.a,{href:"https://github.com/lexmin0412/dify-chat",target:"_blank",rel:"noopener noreferrer",children:"Dify Chat"})," 项目中的一个包，它提供了一套完整的方法来操作 Dify 应用，包括获取应用信息、管理会话、发送消息等功能。"]}),"\n",(0,a.jsx)(n.p,{children:"下面将介绍如何在你的应用中集成和使用它。"}),"\n",(0,a.jsxs)(n.h2,{id:"安装",children:["安装",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#安装",children:"#"})]}),"\n",(0,a.jsx)(n.p,{children:"通过 npm/yarn/pnpm 安装："}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-bash",children:"# npm\nnpm install @dify-chat/api\n\n# yarn\nyarn add @dify-chat/api\n\n# pnpm\npnpm add @dify-chat/api\n"})}),"\n",(0,a.jsxs)(n.h2,{id:"基本使用",children:["基本使用",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#基本使用",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"import { createDifyApiInstance, DifyApi } from '@dify-chat/api';\n\n// 创建实例方式1：使用工厂函数\nconst api = createDifyApiInstance({\n  user: 'user123',\n  apiBase: 'https://api.dify.ai/v1',\n  apiKey: 'app-YOUR_API_KEY',\n});\n\n// 创建实例方式2：直接实例化\nconst api2 = new DifyApi({\n  user: 'user123',\n  apiBase: 'https://api.dify.ai/v1',\n  apiKey: 'app-YOUR_API_KEY',\n});\n\n// 调用API\napi.getAppInfo().then((appInfo) => {\n  console.log(appInfo);\n});\n"})}),"\n",(0,a.jsxs)(n.h2,{id:"api-实例配置",children:["API 实例配置",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#api-实例配置",children:"#"})]}),"\n",(0,a.jsxs)(n.p,{children:["实例化 ",(0,a.jsx)(n.code,{children:"DifyApi"})," 时需要提供以下配置："]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"interface IDifyApiOptions {\n  /**\n   * 用户标识\n   */\n  user: string;\n  /**\n   * API 前缀，默认 https://api.dify.ai/v1\n   */\n  apiBase: string;\n  /**\n   * Dify APP API 密钥\n   */\n  apiKey: string;\n}\n"})}),"\n",(0,a.jsxs)(n.h2,{id:"api-方法",children:["API 方法",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#api-方法",children:"#"})]}),"\n",(0,a.jsxs)(n.blockquote,{children:["\n",(0,a.jsx)(n.p,{children:"注意：开发此包的初衷是为了实现主项目 Dify Chat 的相关功能，所以并不是所有的官方 API 都会存在对应的方法。如需调用其他 API，请自行参考官方文档。"}),"\n"]}),"\n",(0,a.jsxs)(n.h3,{id:"更新-api-配置",children:["更新 API 配置",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#更新-api-配置",children:"#"})]}),"\n",(0,a.jsx)(n.p,{children:"当需要切换应用时，可以更新 API 配置。"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"api.updateOptions({\n  user: 'newUser',\n  apiBase: 'https://api.dify.ai/v1',\n  apiKey: 'app-NEW_API_KEY',\n});\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"获取应用基本信息",children:["获取应用基本信息",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#获取应用基本信息",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const appInfo = await api.getAppInfo();\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"返回值类型："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"interface IGetAppInfoResponse {\n  name: string;\n  description: string;\n  tags: string[];\n}\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"获取应用-meta-信息",children:["获取应用 Meta 信息",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#获取应用-meta-信息",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const appMeta = await api.getAppMeta();\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"返回值类型："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"interface IGetAppMetaResponse {\n  tool_icons: {\n    dalle2: string;\n    api_tool: {\n      background: string;\n      content: string;\n    };\n  };\n}\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"获取应用参数",children:["获取应用参数",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#获取应用参数",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const appParameters = await api.getAppParameters();\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"返回值类型："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"interface IGetAppParametersResponse {\n  opening_statement?: string;\n  user_input_form: IUserInputForm[];\n  suggested_questions?: string[];\n  suggested_questions_after_answer: {\n    enabled: boolean;\n  };\n  file_upload: {\n    enabled: boolean;\n    allowed_file_extensions: string[];\n    allowed_file_types: IFileType[];\n    allowed_file_upload_methods: Array<'remote_url' | 'local_file'>;\n    fileUploadConfig: {\n      file_size_limit: number;\n      batch_count_limit: number;\n      image_file_size_limit: number;\n      video_file_size_limit: number;\n      audio_file_size_limit: number;\n      workflow_file_upload_limit: number;\n    };\n    image: {\n      enabled: false;\n      number_limits: 3;\n      transfer_methods: ['local_file', 'remote_url'];\n    };\n    number_limits: number;\n  };\n  text_to_speech: {\n    enabled: boolean;\n    autoPlay: 'enabled' | 'disabled';\n    language: string;\n    voice: string;\n  };\n  speech_to_text: {\n    enabled: boolean;\n  };\n}\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"会话管理",children:["会话管理",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#会话管理",children:"#"})]}),"\n",(0,a.jsxs)(n.h4,{id:"获取会话列表",children:["获取会话列表",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#获取会话列表",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const conversations = await api.listConversations({ limit: 20 });\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"参数："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"interface IListConversationsRequest {\n  limit: number;\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"返回值类型："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"interface IGetConversationListResponse {\n  data: IConversationItem[];\n}\n\ninterface IConversationItem {\n  created_at: number;\n  id: string;\n  inputs: Record<string, unknown>;\n  introduction: string;\n  name: string;\n  status: 'normal';\n  updated_at: number;\n}\n"})}),"\n",(0,a.jsxs)(n.h4,{id:"重命名会话",children:["重命名会话",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#重命名会话",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"await api.renameConversation({\n  conversation_id: 'conversation_id',\n  name: '新的会话名称',\n});\n\n// 自动生成名称\nawait api.renameConversation({\n  conversation_id: 'conversation_id',\n  auto_generate: true,\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"参数："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"{\n  conversation_id: string;\n  name?: string;\n  auto_generate?: boolean;\n}\n"})}),"\n",(0,a.jsxs)(n.h4,{id:"删除会话",children:["删除会话",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#删除会话",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"await api.deleteConversation('conversation_id');\n"})}),"\n",(0,a.jsxs)(n.h4,{id:"获取会话历史消息",children:["获取会话历史消息",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#获取会话历史消息",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const history = await api.listMessages('conversation_id');\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"返回值类型："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"interface IListMessagesResponse {\n  data: IMessageItem[];\n}\n\ninterface IMessageItem {\n  id: string;\n  conversation_id: string;\n  inputs: Record<string, string>;\n  query: string;\n  answer: string;\n  message_files: [];\n  feedback?: {\n    rating: 'like' | 'dislike';\n  };\n  status: 'normal' | 'error';\n  error: string | null;\n  agent_thoughts?: IAgentThought[];\n  created_at: number;\n  retriever_resources?: IRetrieverResource[];\n}\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"消息相关",children:["消息相关",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#消息相关",children:"#"})]}),"\n",(0,a.jsxs)(n.h4,{id:"发送消息",children:["发送消息",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#发送消息",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const response = await api.sendMessage({\n  conversation_id: 'conversation_id', // 可选，不传则创建新会话\n  inputs: {\n    // 输入参数，键值对形式\n    param1: 'value1',\n  },\n  files: [], // 附件，可以是远程URL或本地上传的文件ID\n  user: 'user123',\n  response_mode: 'streaming',\n  query: '你好，请问...',\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"参数："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"{\n  conversation_id?: string;\n  inputs: Record<string, string>;\n  files: IFile[];\n  user: string;\n  response_mode: 'streaming';\n  query: string;\n}\n"})}),"\n",(0,a.jsxs)(n.h4,{id:"文件类型定义",children:["文件类型定义",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#文件类型定义",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"export type IFileType = 'document' | 'image' | 'audio' | 'video' | 'custom';\n\nexport interface IFileBase {\n  type: IFileType;\n}\n\nexport interface IFileRemote extends IFileBase {\n  transfer_method: 'remote_url';\n  url?: string;\n}\n\nexport interface IFileLocal extends IFileBase {\n  transfer_method: 'local_file';\n  upload_file_id?: string;\n}\n\nexport type IFile = IFileRemote | IFileLocal;\n"})}),"\n",(0,a.jsxs)(n.h4,{id:"停止生成",children:["停止生成",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#停止生成",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"await api.stopTask('taskId');\n"})}),"\n",(0,a.jsxs)(n.h4,{id:"获取下一轮建议问题",children:["获取下一轮建议问题",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#获取下一轮建议问题",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const suggestions = await api.getNextSuggestions({\n  message_id: 'message_id',\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"返回值类型："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"{\n  data: string[]\n}\n"})}),"\n",(0,a.jsxs)(n.h4,{id:"消息反馈",children:["消息反馈",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#消息反馈",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"await api.createMessageFeedback({\n  messageId: 'message_id',\n  rating: 'like', // 'like' | 'dislike' | null\n  content: '反馈内容',\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"参数："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"{\n  messageId: string;\n  rating: 'like' | 'dislike' | null;\n  content: string;\n}\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"文件操作",children:["文件操作",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#文件操作",children:"#"})]}),"\n",(0,a.jsxs)(n.h4,{id:"上传文件",children:["上传文件",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#上传文件",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const fileInfo = await api.uploadFile(file);\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"参数："})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"file"}),": 浏览器 File 对象"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"返回值类型："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"interface IUploadFileResponse {\n  id: string;\n  name: string;\n  size: number;\n  extension: string;\n  mime_type: string;\n  created_by: number;\n  created_at: number;\n}\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"语音相关",children:["语音相关",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#语音相关",children:"#"})]}),"\n",(0,a.jsxs)(n.h4,{id:"文字转语音",children:["文字转语音",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#文字转语音",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"// 通过消息ID转换\nconst audioResponse = await api.text2Audio({\n  message_id: 'message_id',\n});\n\n// 通过文本内容转换\nconst audioResponse2 = await api.text2Audio({\n  text: '要转换的文本内容',\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"参数："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"| {\n    message_id: string;\n  }\n| {\n    text: string;\n  }\n"})}),"\n",(0,a.jsxs)(n.h4,{id:"语音转文字",children:["语音转文字",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#语音转文字",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const textResponse = await api.audio2Text(audioFile);\n"})}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"参数："})}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:[(0,a.jsx)(n.code,{children:"audioFile"}),": 语音文件。支持格式：['mp3', 'mp4', 'mpeg', 'mpga', 'm4a', 'wav', 'webm'] 文件大小限制：15MB"]}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.strong,{children:"返回值类型："})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"interface IAudio2TextResponse {\n  text: string;\n}\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"工作流相关",children:["工作流相关",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#工作流相关",children:"#"})]}),"\n",(0,a.jsxs)(n.h4,{id:"执行-workflow",children:["执行 workflow",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#执行-workflow",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const workflowResponse = await api.runWorkflow({\n  inputs: {\n    // 输入参数，键值对形式\n    param1: 'value1',\n    param2: [\n      /* 文件数组 */\n    ],\n  },\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:"参数："}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"{\n  inputs: Record<string, IFile[] | unknown>;\n}\n"})}),"\n",(0,a.jsxs)(n.h4,{id:"获取-workflow-执行情况",children:["获取 workflow 执行情况",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#获取-workflow-执行情况",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const workflowResult = await api.getWorkflowResult({\n  workflow_run_id: 'workflow_run_id',\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:"参数："}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"{\n  workflow_run_id: string;\n}\n"})}),"\n",(0,a.jsx)(n.p,{children:"响应体："}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"{\n  /** workflow 执行 ID */\n  id: string;\n  /** 关联的 Workflow ID */\n  workflow_id: string;\n  /** 执行状态 running / succeeded / failed / stopped */\n  status: string;\n  /** 任务输入内容 */\n  inputs: object;\n  /** 任务输出内容 */\n  outputs: object;\n  /** 错误原因 */\n  error: string;\n  /** 任务执行总步数 */\n  total_steps: number;\n  /** 任务执行总 tokens */\n  total_tokens: number;\n  /** 任务开始时间 */\n  created_at: number;\n  /** 任务结束时间 */\n  finished_at: number;\n  /** 耗时(s) */\n  elapsed_time: number;\n}\n"})}),"\n",(0,a.jsxs)(n.h3,{id:"文本生成相关",children:["文本生成相关",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#文本生成相关",children:"#"})]}),"\n",(0,a.jsxs)(n.h4,{id:"执行文本生成",children:["执行文本生成",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#执行文本生成",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"const completionResponse = await api.completion({\n  inputs: {\n    // 输入参数，键值对形式\n    param1: 'value1',\n    param2: [\n      /* 文件数组 */\n    ],\n  },\n});\n"})}),"\n",(0,a.jsx)(n.p,{children:"参数："}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"{\n  inputs: Record<string, IFile[] | unknown>;\n}\n"})}),"\n",(0,a.jsxs)(n.h2,{id:"完整事件类型",children:["完整事件类型",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#完整事件类型",children:"#"})]}),"\n",(0,a.jsx)(n.p,{children:"API 响应中包含各种事件类型，完整定义如下："}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"export enum EventEnum {\n  MESSAGE = 'message',\n  AGENT_MESSAGE = 'agent_message',\n  AGENT_THOUGHT = 'agent_thought',\n  MESSAGE_FILE = 'message_file',\n  MESSAGE_END = 'message_end',\n  TTS_MESSAGE = 'tts_message',\n  TTS_MESSAGE_END = 'tts_message_end',\n  MESSAGE_REPLACE = 'message_replace',\n  ERROR = 'error',\n  PING = 'ping',\n  WORKFLOW_STARTED = 'workflow_started',\n  WORKFLOW_FINISHED = 'workflow_finished',\n  WORKFLOW_NODE_STARTED = 'node_started',\n  WORKFLOW_NODE_FINISHED = 'node_finished',\n}\n"})}),"\n",(0,a.jsxs)(n.h2,{id:"示例完整的对话流程",children:["示例：完整的对话流程",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#示例完整的对话流程",children:"#"})]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-ts",children:"import { createDifyApiInstance } from '@dify-chat/api';\n\nasync function chatExample() {\n  // 1. 创建API实例\n  const api = createDifyApiInstance({\n    user: 'user123',\n    apiBase: 'https://api.dify.ai/v1',\n    apiKey: 'app-YOUR_API_KEY',\n  });\n\n  // 2. 获取应用信息\n  const appInfo = await api.getAppInfo();\n  console.log('应用信息:', appInfo);\n\n  // 3. 获取应用参数\n  const appParams = await api.getAppParameters();\n  console.log('应用参数:', appParams);\n\n  // 4. 发送消息\n  const messageStream = await api.sendMessage({\n    inputs: {},\n    files: [],\n    user: 'user123',\n    response_mode: 'streaming',\n    query: '你好，请介绍一下自己',\n  });\n\n  // 5. 处理流式响应\n  const reader = messageStream.body.getReader();\n  const decoder = new TextDecoder();\n\n  while (true) {\n    const { done, value } = await reader.read();\n    if (done) break;\n\n    const chunk = decoder.decode(value);\n    const lines = chunk.split('\\n').filter((line) => line.trim() !== '');\n\n    for (const line of lines) {\n      if (line.startsWith('data: ')) {\n        const data = JSON.parse(line.substring(6));\n        console.log('收到事件:', data.event);\n\n        if (data.event === 'message') {\n          console.log('AI回复内容:', data.answer);\n        } else if (data.event === 'error') {\n          console.error('错误:', data.message);\n        } else if (data.event === 'message_end') {\n          console.log('消息结束');\n        }\n      }\n    }\n  }\n}\n"})}),"\n",(0,a.jsxs)(n.h2,{id:"注意事项",children:["注意事项",(0,a.jsx)(n.a,{className:"header-anchor","aria-hidden":"true",href:"#注意事项",children:"#"})]}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsx)(n.li,{children:"所有 API 方法均返回 Promise，可以使用 async/await 或 .then() 处理"}),"\n",(0,a.jsx)(n.li,{children:"消息发送采用流式响应，需要处理 ReadableStream"}),"\n",(0,a.jsxs)(n.li,{children:["API 密钥格式通常为 ",(0,a.jsx)(n.code,{children:"app-XXXXXXXX"}),"，需要从 Dify 控制台获取"]}),"\n",(0,a.jsx)(n.li,{children:"用户ID可以是任意字符串，用于标识用户身份，便于区分不同用户的会话"}),"\n"]})]})}function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,i.ah)(),e.components);return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(r,{...e})}):r(e)}let d=t;t.__RSPRESS_PAGE_META={},t.__RSPRESS_PAGE_META["Latest%2Fpackages%2Fapi.md"]={toc:[{text:"安装",id:"安装",depth:2},{text:"基本使用",id:"基本使用",depth:2},{text:"API 实例配置",id:"api-实例配置",depth:2},{text:"API 方法",id:"api-方法",depth:2},{text:"更新 API 配置",id:"更新-api-配置",depth:3},{text:"获取应用基本信息",id:"获取应用基本信息",depth:3},{text:"获取应用 Meta 信息",id:"获取应用-meta-信息",depth:3},{text:"获取应用参数",id:"获取应用参数",depth:3},{text:"会话管理",id:"会话管理",depth:3},{text:"获取会话列表",id:"获取会话列表",depth:4},{text:"重命名会话",id:"重命名会话",depth:4},{text:"删除会话",id:"删除会话",depth:4},{text:"获取会话历史消息",id:"获取会话历史消息",depth:4},{text:"消息相关",id:"消息相关",depth:3},{text:"发送消息",id:"发送消息",depth:4},{text:"文件类型定义",id:"文件类型定义",depth:4},{text:"停止生成",id:"停止生成",depth:4},{text:"获取下一轮建议问题",id:"获取下一轮建议问题",depth:4},{text:"消息反馈",id:"消息反馈",depth:4},{text:"文件操作",id:"文件操作",depth:3},{text:"上传文件",id:"上传文件",depth:4},{text:"语音相关",id:"语音相关",depth:3},{text:"文字转语音",id:"文字转语音",depth:4},{text:"语音转文字",id:"语音转文字",depth:4},{text:"工作流相关",id:"工作流相关",depth:3},{text:"执行 workflow",id:"执行-workflow",depth:4},{text:"获取 workflow 执行情况",id:"获取-workflow-执行情况",depth:4},{text:"文本生成相关",id:"文本生成相关",depth:3},{text:"执行文本生成",id:"执行文本生成",depth:4},{text:"完整事件类型",id:"完整事件类型",depth:2},{text:"示例：完整的对话流程",id:"示例完整的对话流程",depth:2},{text:"注意事项",id:"注意事项",depth:2}],title:"`@dify-chat/api`",headingTitle:"`@dify-chat/api`",frontmatter:{}}}}]);